{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/thadzy/Documents/Thadzy/FIBO-Store/frontend/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport GoogleProvider from \"next-auth/providers/google\";\n\nconst handler = NextAuth({\n  providers: [\n    GoogleProvider({\n      clientId: process.env.GOOGLE_CLIENT_ID!,\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,\n    }),\n  ],\n  callbacks: {\n    // 1. ด่านตรวจคนเข้าเมือง: เช็คว่าเป็นอีเมล KMUTT หรือไม่?\n    async signIn({ user }) {\n      if (user.email?.endsWith(\"@mail.kmutt.ac.th\")) {\n        return true; // ผ่าน ✅\n      } else {\n        console.log(\"Access Denied: Non-KMUTT email\");\n        return false; // บล็อก ❌\n      }\n    },\n\n    // 2. ด่านมอบตำแหน่ง: ถ้าเป็น Thadzy ให้เป็น Admin\n    async jwt({ token, user }) {\n      if (user) {\n        // เช็คตรงนี้ครับ! ถ้าอีเมลตรงเป๊ะๆ ให้ถือว่าเป็น admin\n        const admins = [\"thadchai.suks@mail.kmutt.ac.th\"]; \n        \n        token.role = admins.includes(user.email!) ? \"admin\" : \"student\";\n        \n        // (แถม) เก็บ User ID จาก Database จริงมาใส่ตรงนี้ได้ในอนาคต\n        // token.id = user.id \n      }\n      return token;\n    },\n\n    // 3. ส่งข้อมูลไปให้ Frontend ใช้\n    async session({ session, token }: any) {\n      if (session.user) {\n        session.user.role = token.role; // Frontend จะเห็นว่า role คืออะไร\n        session.user.id = token.sub;\n      }\n      return session;\n    },\n  },\n  pages: {\n    signIn: '/login', // ถ้ายังไม่ login ให้เด้งไปหน้านี้ (เดี๋ยวเราไปสร้าง)\n  }\n});\n\nexport { handler as GET, handler as POST };"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,UAAU,IAAA,kJAAQ,EAAC;IACvB,WAAW;QACT,IAAA,gKAAc,EAAC;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;QAChD;KACD;IACD,WAAW;QACT,0DAA0D;QAC1D,MAAM,QAAO,EAAE,IAAI,EAAE;YACnB,IAAI,KAAK,KAAK,EAAE,SAAS,sBAAsB;gBAC7C,OAAO,MAAM,SAAS;YACxB,OAAO;gBACL,QAAQ,GAAG,CAAC;gBACZ,OAAO,OAAO,UAAU;YAC1B;QACF;QAEA,kDAAkD;QAClD,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,uDAAuD;gBACvD,MAAM,SAAS;oBAAC;iBAAiC;gBAEjD,MAAM,IAAI,GAAG,OAAO,QAAQ,CAAC,KAAK,KAAK,IAAK,UAAU;YAEtD,4DAA4D;YAC5D,sBAAsB;YACxB;YACA,OAAO;QACT;QAEA,iCAAiC;QACjC,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAO;YACnC,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI,EAAE,kCAAkC;gBAClE,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG;YAC7B;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;AACF"}}]
}